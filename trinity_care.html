<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trinity Care - Trinity Academy</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    
    <style>
        :root {
            --primary: #4A6FA5;
            --secondary: #FF6B6B;
            --accent: #06D6A0;
            --dark: #1A1A2E;
            --light: #F8F9FF;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #1A237E 0%, #283593 100%);
            min-height: 100vh;
            color: var(--dark);
            padding: 20px;
        }
        
        .app-container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .college-header {
            text-align: center;
            background: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .college-logo {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #1A237E, #3949AB);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 40px;
        }
        
        .college-title {
            color: #1A237E;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 32px;
        }
        
        .college-subtitle {
            color: #4A6FA5;
            font-size: 18px;
        }
        
        .card {
            background: white;
            border-radius: 20px;
            border: none;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .card-header {
            background: linear-gradient(135deg, #1A237E, #3949AB);
            color: white;
            padding: 25px;
            border-radius: 20px 20px 0 0 !important;
        }
        
        .card-body {
            padding: 30px;
        }
        
        .progress-container {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin: 25px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #06D6A0, #4A6FA5);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .quote-box {
            background: linear-gradient(135deg, #FFEFBA, #FFFFFF);
            border-left: 5px solid #06D6A0;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-style: italic;
        }
        
        .description-box {
            background: #f8f9fa;
            border: 2px dashed #4A6FA5;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .description-textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            resize: vertical;
        }
        
        .form-control, .form-select {
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            margin-bottom: 20px;
        }
        
        .btn {
            padding: 15px 35px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 16px;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 5px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #1A237E, #3949AB);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #3949AB, #1A237E);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(26, 35, 126, 0.3);
        }
        
        .success-container {
            text-align: center;
            padding: 40px 20px;
        }
        
        .success-icon {
            font-size: 100px;
            color: #06D6A0;
            margin-bottom: 30px;
        }
        
        .confetti {
            position: fixed;
            width: 15px;
            height: 15px;
            background: #4A6FA5;
            border-radius: 50%;
            animation: fall 3s linear forwards;
        }
        
        @keyframes fall {
            0% { top: -50px; opacity: 1; }
            100% { top: 100vh; opacity: 0; }
        }
        
        @media (max-width: 768px) {
            .college-title {
                font-size: 24px;
            }
            
            .card-body {
                padding: 20px;
            }
            
            .btn {
                padding: 12px 25px;
                width: 100%;
                margin: 5px 0;
            }
        }
        
        .emoji {
            font-size: 24px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div id="app"></div>
    
    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // ====== FIREBASE CONFIGURATION ======
        const firebaseConfig = {
            apiKey: "AIzaSyCrW-S82Cuq9WyWTkpP2BlA8xVdNekqgzI",
            authDomain: "trinity-campus-care.firebaseapp.com",
            projectId: "trinity-campus-care",
            storageBucket: "trinity-campus-care.firebasestorage.app",
            messagingSenderId: "486925280818",
            appId: "1:486925280818:web:3d40ad3f9f76689dbffe2b",
            measurementId: "G-94BMMSS4TQ"
        };
        
        // Initialize Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();
            console.log("‚úÖ Firebase Connected!");
            
            // ====== APPLICATION CODE ======
            let currentPage = 1;
            const totalPages = 5;
            let userData = {
                studentInfo: {},
                surveyAnswers: {},
                urgency: 'medium',
                happyMoments: [],
                consent: false
            };
            
            const quotes = [
                "You are not alone. Every student faces challenges, and it's okay to ask for help. üíô",
                "Your mental health is just as important as your grades. Take care of yourself first. üå±",
                "Small steps lead to big changes. You're already taking the first step by being here. üë£",
                "It's okay not to be okay. What matters is that you're reaching out. ü§ó",
                "Your courage in seeking help will inspire others to do the same. ‚ú®"
            ];
            
            // ====== MAIN FUNCTIONS ======
            function showPage(page) {
                currentPage = page;
                const progress = ((page - 1) / (totalPages - 1)) * 100;
                
                document.getElementById("app").innerHTML = `
                    <div class="app-container">
                        <!-- College Header -->
                        <div class="college-header">
                            <div class="college-logo">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <h1 class="college-title">TRINITY ACADEMY OF ENGINEERING</h1>
                            <p class="college-subtitle">Campus Care Connect - Student Support System</p>
                        </div>
                        
                        <!-- Progress Bar -->
                        <div class="progress-container">
                            <div class="progress-bar" style="width: ${progress}%"></div>
                        </div>
                        
                        <!-- Quote -->
                        <div class="quote-box">
                            <i class="fas fa-quote-left"></i>
                            ${quotes[page - 1]}
                            <i class="fas fa-quote-right"></i>
                        </div>
                        
                        <!-- Page Content -->
                        <div class="card">
                            ${getPageContent(page)}
                        </div>
                        
                        <!-- Navigation -->
                        <div class="d-flex justify-content-between mt-4">
                            ${page > 1 ? `
                                <button class="btn btn-outline-primary" onclick="showPage(${page - 1})">
                                    <i class="fas fa-arrow-left me-2"></i> Back
                                </button>
                            ` : '<div></div>'}
                            
                            ${page < totalPages ? `
                                <button class="btn btn-primary" onclick="validatePage(${page})">
                                    Next <i class="fas fa-arrow-right ms-2"></i>
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            }
            
            function getPageContent(page) {
                switch(page) {
                    case 1:
                        return `
                            <div class="card-header">
                                <h3><i class="fas fa-user-graduate emoji"></i>Student Information</h3>
                                <p>Let's start with your basic details</p>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">Full Name *</label>
                                        <input type="text" class="form-control" id="name" 
                                               placeholder="Enter your full name">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Department *</label>
                                        <select class="form-select" id="department">
                                            <option value="">Select Department</option>
                                            <option value="cse">Computer Science & Engineering</option>
                                            <option value="it">Information Technology</option>
                                            <option value="ece">Electronics & Communication</option>
                                            <option value="eee">Electrical & Electronics</option>
                                            <option value="mech">Mechanical Engineering</option>
                                            <option value="civil">Civil Engineering</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">Email ID *</label>
                                        <input type="email" class="form-control" id="email" 
                                               placeholder="student@trinity.edu">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Phone Number</label>
                                        <input type="tel" class="form-control" id="phone" 
                                               placeholder="+91 9876543210">
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="form-label">Year of Study *</label>
                                    <select class="form-select" id="year">
                                        <option value="">Select Year</option>
                                        <option value="1">First Year</option>
                                        <option value="2">Second Year</option>
                                        <option value="3">Third Year</option>
                                        <option value="4">Fourth Year</option>
                                    </select>
                                </div>
                            </div>
                        `;
                        
                    case 2:
                        return `
                            <div class="card-header">
                                <h3><i class="fas fa-comment-dots emoji"></i>Tell Us Your Story</h3>
                                <p>Share what's on your mind</p>
                            </div>
                            <div class="card-body">
                                <div class="description-box">
                                    <label class="form-label">Describe what you're going through *</label>
                                    <textarea class="description-textarea" id="problemDescription"
                                              placeholder="You can write about academic stress, personal issues, relationships, anxiety, or anything else..."></textarea>
                                    <small class="text-muted">This is your safe space to express yourself</small>
                                </div>
                                
                                <div>
                                    <label class="form-label">What made you smile today? üòä</label>
                                    <input type="text" class="form-control" id="happyMoment"
                                           placeholder="Share one happy moment...">
                                </div>
                            </div>
                        `;
                        
                    case 3:
                        return `
                            <div class="card-header">
                                <h3><i class="fas fa-hands-helping emoji"></i>Support Needed</h3>
                                <p>How can we help you?</p>
                            </div>
                            <div class="card-body">
                                <div class="mb-4">
                                    <label class="form-label">What type of support do you need? *</label>
                                    <select class="form-select" id="supportType">
                                        <option value="">Select your priority</option>
                                        <option value="academic">üìö Academic Support</option>
                                        <option value="mental">üß† Mental Health Support</option>
                                        <option value="physical">üè• Physical Health Support</option>
                                        <option value="social">üë• Social Support</option>
                                        <option value="career">üíº Career Guidance</option>
                                        <option value="other">‚ú® Other</option>
                                    </select>
                                </div>
                                
                                <div id="otherDetails" style="display: none;" class="description-box">
                                    <label class="form-label">Please describe:</label>
                                    <textarea class="description-textarea" id="otherDescription"
                                              placeholder="Tell us what kind of support you need..."></textarea>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label mb-3">How urgent is this? *</label>
                                    <div class="d-flex gap-2">
                                        <button class="btn ${userData.urgency === 'low' ? 'btn-success' : 'btn-outline-success'}" 
                                                onclick="setUrgency('low', this)">
                                            Low Priority
                                        </button>
                                        <button class="btn ${userData.urgency === 'medium' ? 'btn-warning' : 'btn-outline-warning'}" 
                                                onclick="setUrgency('medium', this)">
                                            Medium Priority
                                        </button>
                                        <button class="btn ${userData.urgency === 'high' ? 'btn-danger' : 'btn-outline-danger'}" 
                                                onclick="setUrgency('high', this)">
                                            High Priority
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                    case 4:
                        return `
                            <div class="card-header">
                                <h3><i class="fas fa-star emoji"></i>Final Questions</h3>
                                <p>Almost done!</p>
                            </div>
                            <div class="card-body">
                                <div class="mb-4">
                                    <label class="form-label">What are you passionate about?</label>
                                    <input type="text" class="form-control" id="passion"
                                           placeholder="Sports, music, coding, art...">
                                </div>
                                
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="consent">
                                    <label class="form-check-label" for="consent">
                                        I consent to receive support from Trinity Academy (all information confidential)
                                    </label>
                                </div>
                            </div>
                        `;
                        
                    case 5:
                        return `
                            <div class="success-container">
                                <div class="success-icon">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                
                                <h1 class="mb-4" style="color: #06D6A0;">üéâ SUBMITTED SUCCESSFULLY! üéâ</h1>
                                
                                <div class="card">
                                    <div class="card-header" style="background: #06D6A0;">
                                        <h3 class="text-white"><i class="fas fa-medal me-2"></i>Thank You!</h3>
                                    </div>
                                    <div class="card-body">
                                        <p class="lead mb-4">
                                            You've taken an important step! Our support team will contact you soon.
                                        </p>
                                        
                                        <div class="alert alert-success">
                                            <i class="fab fa-google me-2"></i>
                                            <strong>Powered by Google Firebase!</strong>
                                            <p class="mb-0">Your data is securely stored in the cloud.</p>
                                        </div>
                                        
                                        <div class="d-grid gap-2 mt-4">
                                            <button class="btn btn-primary" onclick="showResources()">
                                                <i class="fas fa-hands-helping me-2"></i>
                                                View Support Resources
                                            </button>
                                            <button class="btn btn-outline-primary" onclick="showPage(1)">
                                                <i class="fas fa-redo me-2"></i>
                                                Submit Another Response
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                }
            }
            
            function setUrgency(level, element) {
                userData.urgency = level;
                const buttons = element.parentElement.querySelectorAll('.btn');
                buttons.forEach(btn => {
                    btn.className = btn.className.replace('btn-success btn-warning btn-danger', 'btn-outline');
                });
                
                if (level === 'low') element.className = element.className.replace('btn-outline', 'btn-success');
                else if (level === 'medium') element.className = element.className.replace('btn-outline', 'btn-warning');
                else if (level === 'high') element.className = element.className.replace('btn-outline', 'btn-danger');
            }
            
            function validatePage(page) {
                if (page === 1) {
                    userData.studentInfo = {
                        name: document.getElementById('name').value,
                        department: document.getElementById('department').value,
                        email: document.getElementById('email').value,
                        phone: document.getElementById('phone').value,
                        year: document.getElementById('year').value
                    };
                    
                    if (!userData.studentInfo.name || !userData.studentInfo.department || 
                        !userData.studentInfo.email || !userData.studentInfo.year) {
                        alert('Please fill all required fields (*)');
                        return;
                    }
                }
                
                if (page === 2) {
                    userData.surveyAnswers.problemDescription = document.getElementById('problemDescription').value;
                    userData.happyMoments[0] = document.getElementById('happyMoment').value;
                    
                    if (!userData.surveyAnswers.problemDescription) {
                        alert('Please describe what you\'re going through');
                        return;
                    }
                }
                
                if (page === 3) {
                    userData.surveyAnswers.supportType = document.getElementById('supportType').value;
                    if (userData.surveyAnswers.supportType === 'other') {
                        userData.surveyAnswers.otherDetails = document.getElementById('otherDescription').value;
                    }
                    
                    if (!userData.surveyAnswers.supportType) {
                        alert('Please select support type');
                        return;
                    }
                }
                
                if (page === 4) {
                    userData.surveyAnswers.passion = document.getElementById('passion').value;
                    userData.consent = document.getElementById('consent').checked;
                    
                    if (!userData.consent) {
                        alert('Please provide consent to proceed');
                        return;
                    }
                    
                    // Submit to Firebase
                    submitData();
                }
                
                showPage(page + 1);
            }
            
            async function submitData() {
                try {
                    const firebaseData = {
                        studentName: userData.studentInfo.name,
                        department: userData.studentInfo.department,
                        email: userData.studentInfo.email,
                        phone: userData.studentInfo.phone,
                        year: userData.studentInfo.year,
                        issue: userData.surveyAnswers.supportType,
                        problem: userData.surveyAnswers.problemDescription,
                        urgency: userData.urgency,
                        happyMoment: userData.happyMoments[0],
                        passion: userData.surveyAnswers.passion,
                        timestamp: new Date().toISOString(),
                        status: "submitted"
                    };
                    
                    await db.collection("studentSubmissions").add(firebaseData);
                    
                    console.log("‚úÖ Data saved to Firebase!");
                    createConfetti();
                    
                } catch (error) {
                    console.error("‚ùå Firebase error:", error);
                    alert("‚úÖ Submitted! (Saved locally)");
                    createConfetti();
                }
            }
            
            function createConfetti() {
                const colors = ['#4A6FA5', '#FF6B6B', '#06D6A0', '#1A237E'];
                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 2 + 's';
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 3000);
                }
            }
            
            function showResources() {
                document.getElementById("app").innerHTML = `
                    <div class="app-container">
                        <div class="college-header">
                            <h2><i class="fas fa-life-ring me-2"></i>Support Resources</h2>
                            <p class="college-subtitle">Trinity Academy of Engineering</p>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3><i class="fas fa-first-aid me-2"></i>Immediate Help</h3>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-danger">
                                    <h5><i class="fas fa-phone-alt me-2"></i>24/7 Crisis Helpline</h5>
                                    <p>üìû 555-HELP-NOW</p>
                                </div>
                                
                                <div class="alert alert-warning">
                                    <h5><i class="fas fa-shield-alt me-2"></i>Campus Security</h5>
                                    <p>üö® 555-EMERGENCY</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3><i class="fas fa-graduation-cap me-2"></i>Academic Support</h3>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-info">
                                    <h5><i class="fas fa-book me-2"></i>Academic Support Center</h5>
                                    <p>üìß academic@trinity.edu</p>
                                </div>
                            </div>
                        </div>
                        
                        <button class="btn btn-primary w-100 mt-3" onclick="showPage(1)">
                            <i class="fas fa-home me-2"></i>Back to Home
                        </button>
                    </div>
                `;
            }
            
            // Show other details when "other" is selected
            document.addEventListener('change', function(e) {
                if (e.target && e.target.id === 'supportType') {
                    const otherDiv = document.getElementById('otherDetails');
                    if (otherDiv) {
                        otherDiv.style.display = e.target.value === 'other' ? 'block' : 'none';
                    }
                }
            });
            
            // Start the app
            window.onload = () => showPage(1);
            
        } catch (error) {
            console.error("‚ùå Firebase initialization failed:", error);
            document.getElementById("app").innerHTML = `
                <div class="app-container">
                    <div class="college-header">
                        <h1 class="college-title">TRINITY ACADEMY OF ENGINEERING</h1>
                        <p class="college-subtitle">Campus Care Connect</p>
                    </div>
                    <div class="alert alert-info">
                        <h4><i class="fas fa-info-circle me-2"></i>Welcome to Campus Care</h4>
                        <p>Click the button below to start your wellness journey.</p>
                        <button class="btn btn-primary mt-2" onclick="startApp()">Start Now</button>
                    </div>
                </div>
            `;
            
            function startApp() {
                showPage(1);
            }
        }
    </script>
</body>
</html>